import matplotlib.pyplot as plt
import pandas as pd
import numpy as np
import seaborn as sns
from sklearn.preprocessing import PowerTransformer
df19 = pd.read_csv("day19_transform.csv")
print("=== Summary Stats (Raw) ===")
print(df19["spend"].describe())
print("Skew (raw):", df19["spend"].skew())
sns.histplot(df19["spend"], kde=True)
plt.title("Spend distribution (raw)")
plt.show()
df19["spend_log1p"] = np.log1p(df19["spend"])
df19["spend_sqrt"] = np.sqrt(df19["spend"])
pt = PowerTransformer(method="yeo-johnson")
df19["spend_yeojohnson"] = pt.fit_transform(df19[["spend"]])
fig, axes = plt.subplots(1, 4, figsize=(16, 4))
sns.histplot(df19["spend"], ax=axes[0], kde=True)
axes[0].set_title("Raw")
sns.histplot(df19["spend_log1p"], ax=axes[1], kde=True)
axes[1].set_title("Log1p")
sns.histplot(df19["spend_sqrt"], ax=axes[2], kde=True)
axes[2].set_title("Sqrt")
sns.histplot(df19["spend_yeojohnson"], ax=axes[3], kde=True)
axes[3].set_title("Yeo-Johnson")
plt.tight_layout()
plt.show()
print("\n=== Skewness Comparison ===")
print("Raw:", df19["spend"].skew())
print("Log1p:", df19["spend_log1p"].skew())
print("Sqrt:", df19["spend_sqrt"].skew())
print("Yeo-Johnson:", df19["spend_yeojohnson"].skew())
print("\n=== Mean Comparison ===")
print("Raw:", df19["spend"].mean())
print("Log1p:", df19["spend_log1p"].mean())
print("Sqrt:", df19["spend_sqrt"].mean())
print("Yeo-Johnson:", df19["spend_yeojohnson"].mean())
