mport pandas as pd
import numpy as np
from sklearn.preprocessing import OneHotEncoder, StandardScaler
from sklearn.linear_model import LinearRegression
from sklearn.metrics import mean_squared_error
df = pd.read_csv("data/day20_integration.csv")
numeric_cols = ["num1", "num2"]
cat_cols     = ["cat1", "cat2"]
target_col   = "target"
X = df[numeric_cols + cat_cols]
y = df[target_col]
scaler = StandardScaler()
X_num_scaled = scaler.fit_transform(X[numeric_cols])
ohe = OneHotEncoder(sparse=False, handle_unknown="ignore")
X_cat_encoded = ohe.fit_transform(X[cat_cols])
X_baseline = np.hstack([X_num_scaled, X_cat_encoded])
interaction = (X[numeric_cols[0]] * X[numeric_cols[1]]).values.reshape(-1, 1)
log_feature = np.log1p(X[numeric_cols[0]].clip(lower=0)).values.reshape(-1, 1)
X_engineered = np.hstack([X_baseline, interaction, log_feature])
model_base = LinearRegression()
model_eng  = LinearRegression()
model_base.fit(X_baseline, y)
y_pred_base = model_base.predict(X_baseline)
mse_base = mean_squared_error(y, y_pred_base)
model_eng.fit(X_engineered, y)
y_pred_eng = model_eng.predict(X_engineered)
mse_eng = mean_squared_error(y, y_pred_eng)
print("Baseline MSE:", mse_base)
print("Engineered MSE:", mse_eng)
